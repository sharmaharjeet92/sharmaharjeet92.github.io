---
layout: post
title:  "My Notes on SuBDomain Takeovers- A Blue Team Prospective"
date:   2020-01-15
excerpt: "SubDomain Takeovers"
tag:
- Threat Hunting 
- Blue Team
- Beginner
- SubDomain Takeovers Monitoring
- Automation 
comments: true
---

Subdomain takeovers are quite common these days and as **Frans Ros√©n** rightly said in his  <a href="https://www.youtube.com/watch?v=HhJv8CU-RIk">talk</a> that SubDomain takeovers are modern day XSS. Companies spends thousands of dollars to buy shiny new tools and suddenly a bug report from bounty hunters made us realize that how a small misconfiguration can cause harm to a company's reputation or assests. While you will get a lot of articles on how to verify if a website subdomain takeover is vulnerable to subdomain takeovers there were very less articles from a blueteam/soc/threat-hunting prospectives. This post is a tiny effort to add something in the later(BlueTeam) section. Most of the content that I will be discussing here is a fusion of great series of posts done by <a href="https://0xpatrik.com/subdomain-takeover-basics/">Patrick Hudak</a>, <a href="https://www.hackerone.com/blog/Guide-Subdomain-Takeovers">HackerOne</a> and <a href="https://labs.detectify.com/2014/10/21/hostile-subdomain-takeover-using-herokugithubdesk-more/">Detectify</a>. I have just tried to organize my understanding of subdomain takeover topic in this blog post. Hopefully it will help someone connecting the dots while they are in the process of understanding subdomain takeover topic.


## What is SubDomain TakeOver
Before proceeding further,lets try to understand what exactly is a domain takeover. If we have to summarize it in short words, it is basically DNS Spoofing. Your browser is blindly trusting the IP address given by DNS resolver to him. The detailed and simpler definition is provided by Patrik Hudak in his article SubDomain TakeOver Basics as:

*"Subdomain takeover is a process of registering a non-existing domain name to gain control over another domain."*

<figure>
	<a href="https://ibb.co/tb28hYW"><img src="https://i.ibb.co/FBYgW8j/a.png" alt="a" border="0"></a>
	<figcaption><a href="http://www.flickr.com/photos/80901381@N04/7758832526/" title="Morning Fog Emerging From Trees by A Guy Taking Pictures, on Flickr">dig results of a domain mybucket.bla.net </a>.</figcaption>
</figure>

Consider the above example where the main domain is pointed to CNAME starting with elasticbeanstalk which further points to s3-r-w.us-west-1.amazonaws.com. Now If aftersome ,I remove all the content from above S3 bucket (s3-r-w.us-west-1.amazonaws.com) then ,it will be released from my AWS account and anybody can register it and when that happens(someone register the s3 bucket with the same name) ,subdomain takeover happens.

Common theoretical example would be you are hosting an event for Saving The Stray Dogs and you register one domain for the same i.e. savethestraydog.com with the domain registrar. Now you hosted a simple static page on S3. After the event is over ,you removed the GitHub page but forgot to  remove the CNAME entry which points to the S3 Static Website. Now an attacker can claim this S3 bucket and can upload anything he/she wants. This is what essentially known as SubDomain Takeover


